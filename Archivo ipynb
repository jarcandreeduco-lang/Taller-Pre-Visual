{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "49878a96",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Defaulting to user installation because normal site-packages is not writeable\n",
      "Requirement already satisfied: openpyxl in c:\\users\\usuario\\appdata\\roaming\\python\\python311\\site-packages (3.1.5)\n",
      "Requirement already satisfied: unidecode in c:\\users\\usuario\\appdata\\roaming\\python\\python311\\site-packages (1.4.0)\n",
      "Requirement already satisfied: et-xmlfile in c:\\users\\usuario\\appdata\\roaming\\python\\python311\\site-packages (from openpyxl) (2.0.0)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n",
      "[notice] A new release of pip is available: 23.2.1 -> 25.3\n",
      "[notice] To update, run: python.exe -m pip install --upgrade pip\n"
     ]
    }
   ],
   "source": [
    "# ------------------------------------------------------------\n",
    "# BLOQUE 0: Instalaci√≥n de librer√≠as necesarias\n",
    "# ------------------------------------------------------------\n",
    "!pip install openpyxl unidecode\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "2bbe66a9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Total de registros cargados: 30\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_id</th>\n",
       "      <th>Fecha Venta</th>\n",
       "      <th>Producto</th>\n",
       "      <th>Region</th>\n",
       "      <th>Pais</th>\n",
       "      <th>Precio_COP</th>\n",
       "      <th>Cantidad</th>\n",
       "      <th>Metodo_pago</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>G00</td>\n",
       "      <td>13 de enero de 1998</td>\n",
       "      <td>Gafas plegables de viaje</td>\n",
       "      <td>Bogot√°</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>87000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>G01</td>\n",
       "      <td>13 de enero de 1998</td>\n",
       "      <td>Gafas polarizadas deportivas</td>\n",
       "      <td>Medell√≠n</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>150000</td>\n",
       "      <td>2</td>\n",
       "      <td>Efectivo</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>M00</td>\n",
       "      <td>13 de enero de 1998</td>\n",
       "      <td>Montura √≥ptica cl√°sica</td>\n",
       "      <td>Cali</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>32000</td>\n",
       "      <td>1</td>\n",
       "      <td>Cheque</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>L00</td>\n",
       "      <td>14 de enero de 1998</td>\n",
       "      <td>Lentes progresivos Premium</td>\n",
       "      <td>Bogot√°</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>125000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>G00</td>\n",
       "      <td>19 de enero de 1998</td>\n",
       "      <td>Gafas plegables de viaje</td>\n",
       "      <td>Barranquilla</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>350000</td>\n",
       "      <td>5</td>\n",
       "      <td>Efectivo</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>G03</td>\n",
       "      <td>21 de enero de 1998</td>\n",
       "      <td>Gafas anti-reflejo est√°ndar</td>\n",
       "      <td>Bogot√°</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>98000</td>\n",
       "      <td>2</td>\n",
       "      <td>Tarjeta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>M00</td>\n",
       "      <td>21 de enero de 1998</td>\n",
       "      <td>Montura √≥ptica cl√°sica</td>\n",
       "      <td>Medell√≠n</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>32000</td>\n",
       "      <td>1</td>\n",
       "      <td>Cheque</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>G04</td>\n",
       "      <td>26 de enero de 1998</td>\n",
       "      <td>Gafas de sol vintage redondas</td>\n",
       "      <td>Cali</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>85000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>E00</td>\n",
       "      <td>28 de enero de 1998</td>\n",
       "      <td>Estuche y pa√±o limpieza (kit)</td>\n",
       "      <td>Bogot√°</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>125000</td>\n",
       "      <td>25</td>\n",
       "      <td>Tarjeta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>G05</td>\n",
       "      <td>29 de enero de 1998</td>\n",
       "      <td>Gafas de seguridad industriales</td>\n",
       "      <td>Bucaramanga</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>180000</td>\n",
       "      <td>3</td>\n",
       "      <td>Efectivo</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>L00</td>\n",
       "      <td>30 de enero de 1998</td>\n",
       "      <td>Lentes progresivos Premium</td>\n",
       "      <td>Medell√≠n</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>125000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>G01</td>\n",
       "      <td>2 de febrero de 1998</td>\n",
       "      <td>Gafas polarizadas deportivas</td>\n",
       "      <td>Cali</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>150000</td>\n",
       "      <td>2</td>\n",
       "      <td>Efectivo</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>M00</td>\n",
       "      <td>2 de febrero de 1998</td>\n",
       "      <td>Montura √≥ptica cl√°sica</td>\n",
       "      <td>Bogot√°</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>128000</td>\n",
       "      <td>4</td>\n",
       "      <td>Cheque</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>G07</td>\n",
       "      <td>2 de febrero de 1998</td>\n",
       "      <td>Gafas de sol deportivas wrap</td>\n",
       "      <td>Barranquilla</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>97000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>L00</td>\n",
       "      <td>2 de febrero de 1998</td>\n",
       "      <td>Lentes progresivos Premium</td>\n",
       "      <td>Bogot√°</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>375000</td>\n",
       "      <td>3</td>\n",
       "      <td>Efectivo</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>G03</td>\n",
       "      <td>3 de febrero de 1998</td>\n",
       "      <td>Gafas anti-reflejo est√°ndar</td>\n",
       "      <td>Medell√≠n</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>98000</td>\n",
       "      <td>2</td>\n",
       "      <td>Tarjeta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>G01</td>\n",
       "      <td>3 de febrero de 1998</td>\n",
       "      <td>Gafas polarizadas deportivas</td>\n",
       "      <td>Bogot√°</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>150000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>G10</td>\n",
       "      <td>5 de febrero de 1998</td>\n",
       "      <td>Gafas para conducci√≥n</td>\n",
       "      <td>Cali</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>120000</td>\n",
       "      <td>2</td>\n",
       "      <td>Efectivo</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>G11</td>\n",
       "      <td>13 de febrero de 1998</td>\n",
       "      <td>Gafas polarizadas espejo</td>\n",
       "      <td>Bogot√°</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>70000</td>\n",
       "      <td>1</td>\n",
       "      <td>Cheque</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>G00</td>\n",
       "      <td>14 de febrero de 1998</td>\n",
       "      <td>Gafas plegables de viaje</td>\n",
       "      <td>Barranquilla</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>87000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>M00</td>\n",
       "      <td>15 de febrero de 1998</td>\n",
       "      <td>Montura √≥ptica cl√°sica</td>\n",
       "      <td>Medell√≠n</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>32000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>G01</td>\n",
       "      <td>18 de febrero de 1998</td>\n",
       "      <td>Gafas polarizadas deportivas</td>\n",
       "      <td>Bogot√°</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>450000</td>\n",
       "      <td>3</td>\n",
       "      <td>Cheque</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>G01</td>\n",
       "      <td>18 de febrero de 1998</td>\n",
       "      <td>Gafas polarizadas deportivas</td>\n",
       "      <td>Cali</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>150000</td>\n",
       "      <td>2</td>\n",
       "      <td>Tarjeta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>L00</td>\n",
       "      <td>25 de febrero de 1998</td>\n",
       "      <td>Lentes progresivos Premium</td>\n",
       "      <td>Bogot√°</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>125000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>G15</td>\n",
       "      <td>27 de febrero de 1998</td>\n",
       "      <td>Gafas bifocales cl√°sicas</td>\n",
       "      <td>Barranquilla</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>115000</td>\n",
       "      <td>1</td>\n",
       "      <td>Efectivo</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>G16</td>\n",
       "      <td>3 de marzo de 1998</td>\n",
       "      <td>Gafas plegables de viaje</td>\n",
       "      <td>Medell√≠n</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>87000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>M04</td>\n",
       "      <td>3 de marzo de 1998</td>\n",
       "      <td>Montura deportiva ligera</td>\n",
       "      <td>Cali</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>240000</td>\n",
       "      <td>3</td>\n",
       "      <td>Efectivo</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>G17</td>\n",
       "      <td>6 de marzo de 1998</td>\n",
       "      <td>Gafas polarizadas premium</td>\n",
       "      <td>Bogot√°</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>200000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>K00</td>\n",
       "      <td>8 de marzo de 1998</td>\n",
       "      <td>Kit reparaci√≥n lentes (tornillos, pa√±o)</td>\n",
       "      <td>Bogot√°</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>10000</td>\n",
       "      <td>1</td>\n",
       "      <td>Efectivo</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>G18</td>\n",
       "      <td>11 de marzo de 1998</td>\n",
       "      <td>Gafas plegables de viaje</td>\n",
       "      <td>Cali</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>87000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_id            Fecha Venta                                 Producto  \\\n",
       "0       G00    13 de enero de 1998                 Gafas plegables de viaje   \n",
       "1       G01    13 de enero de 1998             Gafas polarizadas deportivas   \n",
       "2       M00    13 de enero de 1998                   Montura √≥ptica cl√°sica   \n",
       "3       L00    14 de enero de 1998               Lentes progresivos Premium   \n",
       "4       G00    19 de enero de 1998                 Gafas plegables de viaje   \n",
       "5       G03    21 de enero de 1998              Gafas anti-reflejo est√°ndar   \n",
       "6       M00    21 de enero de 1998                   Montura √≥ptica cl√°sica   \n",
       "7       G04    26 de enero de 1998            Gafas de sol vintage redondas   \n",
       "8       E00    28 de enero de 1998            Estuche y pa√±o limpieza (kit)   \n",
       "9       G05    29 de enero de 1998          Gafas de seguridad industriales   \n",
       "10      L00    30 de enero de 1998               Lentes progresivos Premium   \n",
       "11      G01   2 de febrero de 1998             Gafas polarizadas deportivas   \n",
       "12      M00   2 de febrero de 1998                   Montura √≥ptica cl√°sica   \n",
       "13      G07   2 de febrero de 1998             Gafas de sol deportivas wrap   \n",
       "14      L00   2 de febrero de 1998               Lentes progresivos Premium   \n",
       "15      G03   3 de febrero de 1998              Gafas anti-reflejo est√°ndar   \n",
       "16      G01   3 de febrero de 1998             Gafas polarizadas deportivas   \n",
       "17      G10   5 de febrero de 1998                    Gafas para conducci√≥n   \n",
       "18      G11  13 de febrero de 1998                 Gafas polarizadas espejo   \n",
       "19      G00  14 de febrero de 1998                 Gafas plegables de viaje   \n",
       "20      M00  15 de febrero de 1998                   Montura √≥ptica cl√°sica   \n",
       "21      G01  18 de febrero de 1998             Gafas polarizadas deportivas   \n",
       "22      G01  18 de febrero de 1998             Gafas polarizadas deportivas   \n",
       "23      L00  25 de febrero de 1998               Lentes progresivos Premium   \n",
       "24      G15  27 de febrero de 1998                 Gafas bifocales cl√°sicas   \n",
       "25      G16     3 de marzo de 1998                 Gafas plegables de viaje   \n",
       "26      M04     3 de marzo de 1998                 Montura deportiva ligera   \n",
       "27      G17     6 de marzo de 1998                Gafas polarizadas premium   \n",
       "28      K00     8 de marzo de 1998  Kit reparaci√≥n lentes (tornillos, pa√±o)   \n",
       "29      G18    11 de marzo de 1998                 Gafas plegables de viaje   \n",
       "\n",
       "          Region      Pais  Precio_COP  Cantidad Metodo_pago  \n",
       "0         Bogot√°  Colombia       87000         1     Tarjeta  \n",
       "1       Medell√≠n  Colombia      150000         2    Efectivo  \n",
       "2           Cali  Colombia       32000         1      Cheque  \n",
       "3         Bogot√°  Colombia      125000         1     Tarjeta  \n",
       "4   Barranquilla  Colombia      350000         5    Efectivo  \n",
       "5         Bogot√°  Colombia       98000         2     Tarjeta  \n",
       "6       Medell√≠n  Colombia       32000         1      Cheque  \n",
       "7           Cali  Colombia       85000         1     Tarjeta  \n",
       "8         Bogot√°  Colombia      125000        25     Tarjeta  \n",
       "9    Bucaramanga  Colombia      180000         3    Efectivo  \n",
       "10      Medell√≠n  Colombia      125000         1     Tarjeta  \n",
       "11          Cali  Colombia      150000         2    Efectivo  \n",
       "12        Bogot√°  Colombia      128000         4      Cheque  \n",
       "13  Barranquilla  Colombia       97000         1     Tarjeta  \n",
       "14        Bogot√°  Colombia      375000         3    Efectivo  \n",
       "15      Medell√≠n  Colombia       98000         2     Tarjeta  \n",
       "16        Bogot√°  Colombia      150000         1     Tarjeta  \n",
       "17          Cali  Colombia      120000         2    Efectivo  \n",
       "18        Bogot√°  Colombia       70000         1      Cheque  \n",
       "19  Barranquilla  Colombia       87000         1     Tarjeta  \n",
       "20      Medell√≠n  Colombia       32000         1     Tarjeta  \n",
       "21        Bogot√°  Colombia      450000         3      Cheque  \n",
       "22          Cali  Colombia      150000         2     Tarjeta  \n",
       "23        Bogot√°  Colombia      125000         1     Tarjeta  \n",
       "24  Barranquilla  Colombia      115000         1    Efectivo  \n",
       "25      Medell√≠n  Colombia       87000         1     Tarjeta  \n",
       "26          Cali  Colombia      240000         3    Efectivo  \n",
       "27        Bogot√°  Colombia      200000         1     Tarjeta  \n",
       "28        Bogot√°  Colombia       10000         1    Efectivo  \n",
       "29          Cali  Colombia       87000         1     Tarjeta  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# ------------------------------------------------------------\n",
    "# BLOQUE 1: Importar librer√≠as y cargar datos base\n",
    "# ------------------------------------------------------------\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import re\n",
    "from unidecode import unidecode\n",
    "from IPython.display import display\n",
    "\n",
    "# Creamos manualmente la tabla original de ventas globales (datos sucios)\n",
    "data = [\n",
    "    [\"G00\", \"13 de enero de 1998\", \"Gafas plegables de viaje\", \"Bogot√°\", \"Colombia\", 87000, 1, \"Tarjeta\"],\n",
    "    [\"G01\", \"13 de enero de 1998\", \"Gafas polarizadas deportivas\", \"Medell√≠n\", \"Colombia\", 150000, 2, \"Efectivo\"],\n",
    "    [\"M00\", \"13 de enero de 1998\",\"Montura √≥ptica cl√°sica\", \"Cali\", \"Colombia\", 32000, 1, \"Cheque\"],\n",
    "    [\"L00\", \"14 de enero de 1998\", \"Lentes progresivos Premium\", \"Bogot√°\", \"Colombia\", 125000, 1, \"Tarjeta\"],\n",
    "    [\"G00\", \"19 de enero de 1998\", \"Gafas plegables de viaje\", \"Barranquilla\", \"Colombia\", 350000, 5, \"Efectivo\"],\n",
    "    [\"G03\", \"21 de enero de 1998\", \"Gafas anti-reflejo est√°ndar\", \"Bogot√°\", \"Colombia\", 98000, 2, \"Tarjeta\"],\n",
    "    [\"M00\", \"21 de enero de 1998\", \"Montura √≥ptica cl√°sica\", \"Medell√≠n\", \"Colombia\", 32000, 1, \"Cheque\"],\n",
    "    [\"G04\", \"26 de enero de 1998\", \"Gafas de sol vintage redondas\", \"Cali\", \"Colombia\", 85000, 1, \"Tarjeta\"],\n",
    "    [\"E00\", \"28 de enero de 1998\", \"Estuche y pa√±o limpieza (kit)\", \"Bogot√°\", \"Colombia\", 125000, 25, \"Tarjeta\"],\n",
    "    [\"G05\", \"29 de enero de 1998\", \"Gafas de seguridad industriales\", \"Bucaramanga\", \"Colombia\", 180000, 3, \"Efectivo\"],\n",
    "    [\"L00\", \"30 de enero de 1998\", \"Lentes progresivos Premium\", \"Medell√≠n\", \"Colombia\", 125000, 1, \"Tarjeta\"],\n",
    "    [\"G01\", \"2 de febrero de 1998\", \"Gafas polarizadas deportivas\", \"Cali\", \"Colombia\", 150000, 2, \"Efectivo\"],\n",
    "    [\"M00\", \"2 de febrero de 1998\", \"Montura √≥ptica cl√°sica\", \"Bogot√°\", \"Colombia\", 128000, 4, \"Cheque\"],\n",
    "    [\"G07\", \"2 de febrero de 1998\", \"Gafas de sol deportivas wrap\", \"Barranquilla\", \"Colombia\", 97000, 1, \"Tarjeta\"],\n",
    "    [\"L00\", \"2 de febrero de 1998\", \"Lentes progresivos Premium\", \"Bogot√°\", \"Colombia\", 375000, 3, \"Efectivo\"],\n",
    "    [\"G03\", \"3 de febrero de 1998\", \"Gafas anti-reflejo est√°ndar\", \"Medell√≠n\", \"Colombia\", 98000, 2, \"Tarjeta\"],\n",
    "    [\"G01\", \"3 de febrero de 1998\", \"Gafas polarizadas deportivas\", \"Bogot√°\", \"Colombia\", 150000, 1, \"Tarjeta\"],\n",
    "    [\"G10\", \"5 de febrero de 1998\", \"Gafas para conducci√≥n\", \"Cali\", \"Colombia\", 120000, 2, \"Efectivo\"],\n",
    "    [\"G11\", \"13 de febrero de 1998\", \"Gafas polarizadas espejo\", \"Bogot√°\", \"Colombia\", 70000, 1, \"Cheque\"],\n",
    "    [\"G00\", \"14 de febrero de 1998\", \"Gafas plegables de viaje\", \"Barranquilla\", \"Colombia\", 87000, 1, \"Tarjeta\"],\n",
    "    [\"M00\", \"15 de febrero de 1998\", \"Montura √≥ptica cl√°sica\", \"Medell√≠n\", \"Colombia\", 32000, 1, \"Tarjeta\"],\n",
    "    [\"G01\", \"18 de febrero de 1998\", \"Gafas polarizadas deportivas\", \"Bogot√°\", \"Colombia\", 450000, 3, \"Cheque\"],\n",
    "    [\"G01\", \"18 de febrero de 1998\", \"Gafas polarizadas deportivas\", \"Cali\", \"Colombia\", 150000, 2, \"Tarjeta\"],\n",
    "    [\"L00\", \"25 de febrero de 1998\", \"Lentes progresivos Premium\", \"Bogot√°\", \"Colombia\", 125000, 1, \"Tarjeta\"],\n",
    "    [\"G15\", \"27 de febrero de 1998\", \"Gafas bifocales cl√°sicas\", \"Barranquilla\", \"Colombia\", 115000, 1, \"Efectivo\"],\n",
    "    [\"G16\", \"3 de marzo de 1998\", \"Gafas plegables de viaje\", \"Medell√≠n\", \"Colombia\", 87000, 1, \"Tarjeta\"],\n",
    "    [\"M04\", \"3 de marzo de 1998\", \"Montura deportiva ligera\", \"Cali\", \"Colombia\", 240000, 3, \"Efectivo\"],\n",
    "    [\"G17\", \"6 de marzo de 1998\", \"Gafas polarizadas premium\", \"Bogot√°\", \"Colombia\", 200000, 1, \"Tarjeta\"],\n",
    "    [\"K00\", \"8 de marzo de 1998\", \"Kit reparaci√≥n lentes (tornillos, pa√±o)\", \"Bogot√°\", \"Colombia\", 10000, 1, \"Efectivo\"],\n",
    "    [\"G18\", \"11 de marzo de 1998\", \"Gafas plegables de viaje\", \"Cali\", \"Colombia\", 87000, 1, \"Tarjeta\"],\n",
    "]\n",
    "import datetime\n",
    "\n",
    "\n",
    "df = pd.DataFrame(data, columns=[\"Order_id\", \"Fecha Venta\", \"Producto\",\"Region\",\"Pais\",\"Precio_COP\",\"Cantidad\",\"Metodo_pago\"])\n",
    "\n",
    "print(f\"Total de registros cargados: {len(df)}\")\n",
    "display(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "a2e4aabb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Informaci√≥n general del dataframe:\n",
      "Total de filas: 30\n",
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 30 entries, 0 to 29\n",
      "Data columns (total 8 columns):\n",
      " #   Column       Non-Null Count  Dtype \n",
      "---  ------       --------------  ----- \n",
      " 0   Order_id     30 non-null     object\n",
      " 1   Fecha Venta  30 non-null     object\n",
      " 2   Producto     30 non-null     object\n",
      " 3   Region       30 non-null     object\n",
      " 4   Pais         30 non-null     object\n",
      " 5   Precio_COP   30 non-null     int64 \n",
      " 6   Cantidad     30 non-null     int64 \n",
      " 7   Metodo_pago  30 non-null     object\n",
      "dtypes: int64(2), object(6)\n",
      "memory usage: 2.0+ KB\n",
      "\n",
      "Valores nulos por columna:\n",
      "Order_id       0\n",
      "Fecha Venta    0\n",
      "Producto       0\n",
      "Region         0\n",
      "Pais           0\n",
      "Precio_COP     0\n",
      "Cantidad       0\n",
      "Metodo_pago    0\n",
      "dtype: int64\n",
      "\n",
      "Estad√≠sticas num√©ricas:\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Precio_COP</th>\n",
       "      <th>Cantidad</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>30.000000</td>\n",
       "      <td>30.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>138666.666667</td>\n",
       "      <td>2.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>99908.693948</td>\n",
       "      <td>4.376662</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>10000.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>87000.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>122500.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>150000.000000</td>\n",
       "      <td>2.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>450000.000000</td>\n",
       "      <td>25.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          Precio_COP   Cantidad\n",
       "count      30.000000  30.000000\n",
       "mean   138666.666667   2.500000\n",
       "std     99908.693948   4.376662\n",
       "min     10000.000000   1.000000\n",
       "25%     87000.000000   1.000000\n",
       "50%    122500.000000   1.000000\n",
       "75%    150000.000000   2.000000\n",
       "max    450000.000000  25.000000"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# BLOQUE 2 ‚Äî Diagn√≥stico inicial\n",
    "\n",
    "print(\"Informaci√≥n general del dataframe:\")\n",
    "print(f\"Total de filas: {len(df)}\")\n",
    "df.info()\n",
    "\n",
    "print(\"\\nValores nulos por columna:\")\n",
    "print(df.isnull().sum())\n",
    "\n",
    "print(\"\\nEstad√≠sticas num√©ricas:\")\n",
    "display(df.describe())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "f80428a3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Duplicados detectados (en Order_id): 18\n",
      "\n",
      "--- RESUMEN DE LIMPIEZA BLOQUE 3 ---\n",
      "Registros originales: 30\n",
      "Registros despu√©s de limpieza: 17\n",
      "Registros eliminados: 13\n",
      "\n",
      "Valores nulos post-limpieza:\n",
      "Order_id           0\n",
      "Fecha Venta        0\n",
      "Producto           0\n",
      "Region             0\n",
      "Pais               0\n",
      "Precio_COP         0\n",
      "Cantidad           0\n",
      "Metodo_pago        0\n",
      "Total_venta_COP    0\n",
      "dtype: int64\n",
      "\n",
      "Muestra de datos limpios:\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_id</th>\n",
       "      <th>Fecha Venta</th>\n",
       "      <th>Producto</th>\n",
       "      <th>Region</th>\n",
       "      <th>Pais</th>\n",
       "      <th>Precio_COP</th>\n",
       "      <th>Cantidad</th>\n",
       "      <th>Metodo_pago</th>\n",
       "      <th>Total_venta_COP</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>G00</td>\n",
       "      <td>13 de enero de 1998</td>\n",
       "      <td>Gafas Plegables De Viaje</td>\n",
       "      <td>Bogota</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>87000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "      <td>87000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>G01</td>\n",
       "      <td>13 de enero de 1998</td>\n",
       "      <td>Gafas Polarizadas Deportivas</td>\n",
       "      <td>Medellin</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>150000</td>\n",
       "      <td>2</td>\n",
       "      <td>Efectivo</td>\n",
       "      <td>300000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>M00</td>\n",
       "      <td>13 de enero de 1998</td>\n",
       "      <td>Montura Optica Clasica</td>\n",
       "      <td>Cali</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>32000</td>\n",
       "      <td>1</td>\n",
       "      <td>Cheque</td>\n",
       "      <td>32000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>L00</td>\n",
       "      <td>14 de enero de 1998</td>\n",
       "      <td>Lentes Progresivos Premium</td>\n",
       "      <td>Bogota</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>125000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "      <td>125000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>G03</td>\n",
       "      <td>21 de enero de 1998</td>\n",
       "      <td>Gafas Anti-Reflejo Estandar</td>\n",
       "      <td>Bogota</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>98000</td>\n",
       "      <td>2</td>\n",
       "      <td>Tarjeta</td>\n",
       "      <td>196000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>G04</td>\n",
       "      <td>26 de enero de 1998</td>\n",
       "      <td>Gafas De Sol Vintage Redondas</td>\n",
       "      <td>Cali</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>85000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "      <td>85000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>E00</td>\n",
       "      <td>28 de enero de 1998</td>\n",
       "      <td>Estuche Y Pano Limpieza (Kit)</td>\n",
       "      <td>Bogota</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>125000</td>\n",
       "      <td>25</td>\n",
       "      <td>Tarjeta</td>\n",
       "      <td>3125000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>G05</td>\n",
       "      <td>29 de enero de 1998</td>\n",
       "      <td>Gafas De Seguridad Industriales</td>\n",
       "      <td>Bucaramanga</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>180000</td>\n",
       "      <td>3</td>\n",
       "      <td>Efectivo</td>\n",
       "      <td>540000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>G07</td>\n",
       "      <td>2 de febrero de 1998</td>\n",
       "      <td>Gafas De Sol Deportivas Wrap</td>\n",
       "      <td>Barranquilla</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>97000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "      <td>97000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>G10</td>\n",
       "      <td>5 de febrero de 1998</td>\n",
       "      <td>Gafas Para Conduccion</td>\n",
       "      <td>Cali</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>120000</td>\n",
       "      <td>2</td>\n",
       "      <td>Efectivo</td>\n",
       "      <td>240000.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_id           Fecha Venta                         Producto  \\\n",
       "0       G00   13 de enero de 1998         Gafas Plegables De Viaje   \n",
       "1       G01   13 de enero de 1998     Gafas Polarizadas Deportivas   \n",
       "2       M00   13 de enero de 1998           Montura Optica Clasica   \n",
       "3       L00   14 de enero de 1998       Lentes Progresivos Premium   \n",
       "5       G03   21 de enero de 1998      Gafas Anti-Reflejo Estandar   \n",
       "7       G04   26 de enero de 1998    Gafas De Sol Vintage Redondas   \n",
       "8       E00   28 de enero de 1998    Estuche Y Pano Limpieza (Kit)   \n",
       "9       G05   29 de enero de 1998  Gafas De Seguridad Industriales   \n",
       "13      G07  2 de febrero de 1998     Gafas De Sol Deportivas Wrap   \n",
       "17      G10  5 de febrero de 1998            Gafas Para Conduccion   \n",
       "\n",
       "          Region      Pais  Precio_COP  Cantidad Metodo_pago  Total_venta_COP  \n",
       "0         Bogota  Colombia       87000         1     Tarjeta          87000.0  \n",
       "1       Medellin  Colombia      150000         2    Efectivo         300000.0  \n",
       "2           Cali  Colombia       32000         1      Cheque          32000.0  \n",
       "3         Bogota  Colombia      125000         1     Tarjeta         125000.0  \n",
       "5         Bogota  Colombia       98000         2     Tarjeta         196000.0  \n",
       "7           Cali  Colombia       85000         1     Tarjeta          85000.0  \n",
       "8         Bogota  Colombia      125000        25     Tarjeta        3125000.0  \n",
       "9    Bucaramanga  Colombia      180000         3    Efectivo         540000.0  \n",
       "13  Barranquilla  Colombia       97000         1     Tarjeta          97000.0  \n",
       "17          Cali  Colombia      120000         2    Efectivo         240000.0  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# -----------------------------\n",
    "# BLOQUE 3 ‚Äî Limpieza avanzada (VERSI√ìN DEFENSIVA)\n",
    "# -----------------------------\n",
    "import pandas as pd\n",
    "from unidecode import unidecode\n",
    "\n",
    "# 0) Verificar que 'df' exista\n",
    "try:\n",
    "    _ = df\n",
    "except NameError:\n",
    "    raise NameError(\"El DataFrame 'df' no est√° definido. Ejecuta BLOQUE 1 para cargar los datos antes de ejecutar BLOQUE 3.\")\n",
    "\n",
    "# 1) Copiar dataframe (defensivo)\n",
    "df_clean = df.copy()\n",
    "\n",
    "# 2) Funci√≥n de normalizaci√≥n\n",
    "def normalizar_texto(texto):\n",
    "    if pd.isna(texto):\n",
    "        return None\n",
    "    texto_normalizado = unidecode(str(texto).strip())\n",
    "    return texto_normalizado.title()\n",
    "\n",
    "# 3) Comprobar columnas esperadas y crear si faltan (evita KeyError)\n",
    "expected_cols = [\"Producto\", \"Region\", \"Pais\", \"Metodo_pago\", \"Precio_COP\", \"Cantidad\", \"Order_id\"]\n",
    "for col in expected_cols:\n",
    "    if col not in df_clean.columns:\n",
    "        # Si falta una columna cr√≠tica lanza error claro\n",
    "        if col in [\"Precio_COP\", \"Cantidad\", \"Order_id\"]:\n",
    "            raise KeyError(f\"La columna requerida '{col}' no existe en el DataFrame original.\")\n",
    "        # Si es una columna de texto opcional, cr√©ala vac√≠a para poder normalizar sin fallos\n",
    "        df_clean[col] = None\n",
    "        print(f\"Aviso: se cre√≥ columna vac√≠a '{col}' porque no exist√≠a.\")\n",
    "\n",
    "# 4) Normalizar columnas de texto de manera segura\n",
    "for col in [\"Producto\", \"Region\", \"Pais\"]:\n",
    "    # Si hay valores no-string, la funci√≥n los maneja convirtiendo a str\n",
    "    df_clean[col] = df_clean[col].apply(normalizar_texto)\n",
    "\n",
    "# Metodo_pago: convertir a str antes de m√©todos de string para evitar errores con NaN\n",
    "df_clean[\"Metodo_pago\"] = df_clean[\"Metodo_pago\"].astype(str).str.strip().str.title()\n",
    "\n",
    "# 5) Convertir a num√©ricos de forma robusta\n",
    "df_clean[\"Precio_COP\"] = pd.to_numeric(df_clean[\"Precio_COP\"], errors=\"coerce\")\n",
    "# Cantidad puede contener NA -> usar convertible a numeric y luego tipo nullable Int64\n",
    "df_clean[\"Cantidad\"] = pd.to_numeric(df_clean[\"Cantidad\"], errors=\"coerce\")\n",
    "try:\n",
    "    df_clean[\"Cantidad\"] = df_clean[\"Cantidad\"].astype(\"Int64\")\n",
    "except Exception as e:\n",
    "    # Si falla, dejarlo como float pero avisar\n",
    "    print(\"Advertencia: no fue posible convertir 'Cantidad' a Int64, se mantiene como float. Error:\", e)\n",
    "\n",
    "# 6) Filtrar filas inv√°lidas (gt devuelve False para NA)\n",
    "mask_validos = df_clean[\"Precio_COP\"].gt(0) & df_clean[\"Cantidad\"].gt(0)\n",
    "# Reportar cu√°ntas filas inv√°lidas hay antes de filtrar\n",
    "n_invalid = (~mask_validos).sum()\n",
    "if n_invalid > 0:\n",
    "    print(f\"Aviso: se eliminar√°n {n_invalid} filas con Precio_COP<=0 o Cantidad<=0 o valores faltantes.\")\n",
    "df_clean = df_clean[mask_validos].copy()\n",
    "\n",
    "# 7) Crear columna derivada Total_venta_COP (manejo defensivo si Cantidad es nullable)\n",
    "# Si Cantidad es Int64 (nullable) la multiplicaci√≥n funciona correctamente; si no, convierto temporalmente a float\n",
    "if \"Cantidad\" in df_clean.columns:\n",
    "    df_clean[\"Total_venta_COP\"] = df_clean[\"Precio_COP\"] * df_clean[\"Cantidad\"].astype(float)\n",
    "else:\n",
    "    df_clean[\"Total_venta_COP\"] = df_clean[\"Precio_COP\"] * 1.0\n",
    "\n",
    "# 8) Detecci√≥n de duplicados por Order_id\n",
    "if \"Order_id\" in df_clean.columns:\n",
    "    duplicados_mask = df_clean.duplicated(subset=[\"Order_id\"], keep=False)\n",
    "    n_duplicados = duplicados_mask.sum()\n",
    "    print(f\"Duplicados detectados (en Order_id): {n_duplicados}\")\n",
    "    # Mantener el primer registro por Order_id\n",
    "    df_clean = df_clean.drop_duplicates(subset=[\"Order_id\"], keep=\"first\").copy()\n",
    "else:\n",
    "    print(\"Aviso: no se encontr√≥ 'Order_id'. No se realizar√° chequeo de duplicados.\")\n",
    "\n",
    "# 9) Resumen final\n",
    "print(\"\\n--- RESUMEN DE LIMPIEZA BLOQUE 3 ---\")\n",
    "print(f\"Registros originales: {len(df)}\")\n",
    "print(f\"Registros despu√©s de limpieza: {len(df_clean)}\")\n",
    "print(f\"Registros eliminados: {len(df) - len(df_clean)}\")\n",
    "\n",
    "print(\"\\nValores nulos post-limpieza:\")\n",
    "print(df_clean.isnull().sum())\n",
    "\n",
    "print(\"\\nMuestra de datos limpios:\")\n",
    "display(df_clean.head(10))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "3097497b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "--- C√ÅLCULO DE IVA COMPLETADO ---\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Producto</th>\n",
       "      <th>Precio_COP</th>\n",
       "      <th>IVA_19</th>\n",
       "      <th>Precio_con_IVA</th>\n",
       "      <th>Cantidad</th>\n",
       "      <th>Total_venta_con_IVA</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Gafas Plegables De Viaje</td>\n",
       "      <td>87000</td>\n",
       "      <td>16530.0</td>\n",
       "      <td>103530.0</td>\n",
       "      <td>1</td>\n",
       "      <td>103530.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Gafas Polarizadas Deportivas</td>\n",
       "      <td>150000</td>\n",
       "      <td>28500.0</td>\n",
       "      <td>178500.0</td>\n",
       "      <td>2</td>\n",
       "      <td>357000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Montura Optica Clasica</td>\n",
       "      <td>32000</td>\n",
       "      <td>6080.0</td>\n",
       "      <td>38080.0</td>\n",
       "      <td>1</td>\n",
       "      <td>38080.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Lentes Progresivos Premium</td>\n",
       "      <td>125000</td>\n",
       "      <td>23750.0</td>\n",
       "      <td>148750.0</td>\n",
       "      <td>1</td>\n",
       "      <td>148750.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Gafas Anti-Reflejo Estandar</td>\n",
       "      <td>98000</td>\n",
       "      <td>18620.0</td>\n",
       "      <td>116620.0</td>\n",
       "      <td>2</td>\n",
       "      <td>233240.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Gafas De Sol Vintage Redondas</td>\n",
       "      <td>85000</td>\n",
       "      <td>16150.0</td>\n",
       "      <td>101150.0</td>\n",
       "      <td>1</td>\n",
       "      <td>101150.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Estuche Y Pano Limpieza (Kit)</td>\n",
       "      <td>125000</td>\n",
       "      <td>23750.0</td>\n",
       "      <td>148750.0</td>\n",
       "      <td>25</td>\n",
       "      <td>3718750.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Gafas De Seguridad Industriales</td>\n",
       "      <td>180000</td>\n",
       "      <td>34200.0</td>\n",
       "      <td>214200.0</td>\n",
       "      <td>3</td>\n",
       "      <td>642600.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Gafas De Sol Deportivas Wrap</td>\n",
       "      <td>97000</td>\n",
       "      <td>18430.0</td>\n",
       "      <td>115430.0</td>\n",
       "      <td>1</td>\n",
       "      <td>115430.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Gafas Para Conduccion</td>\n",
       "      <td>120000</td>\n",
       "      <td>22800.0</td>\n",
       "      <td>142800.0</td>\n",
       "      <td>2</td>\n",
       "      <td>285600.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                           Producto  Precio_COP   IVA_19  Precio_con_IVA  \\\n",
       "0          Gafas Plegables De Viaje       87000  16530.0        103530.0   \n",
       "1      Gafas Polarizadas Deportivas      150000  28500.0        178500.0   \n",
       "2            Montura Optica Clasica       32000   6080.0         38080.0   \n",
       "3        Lentes Progresivos Premium      125000  23750.0        148750.0   \n",
       "5       Gafas Anti-Reflejo Estandar       98000  18620.0        116620.0   \n",
       "7     Gafas De Sol Vintage Redondas       85000  16150.0        101150.0   \n",
       "8     Estuche Y Pano Limpieza (Kit)      125000  23750.0        148750.0   \n",
       "9   Gafas De Seguridad Industriales      180000  34200.0        214200.0   \n",
       "13     Gafas De Sol Deportivas Wrap       97000  18430.0        115430.0   \n",
       "17            Gafas Para Conduccion      120000  22800.0        142800.0   \n",
       "\n",
       "    Cantidad  Total_venta_con_IVA  \n",
       "0          1             103530.0  \n",
       "1          2             357000.0  \n",
       "2          1              38080.0  \n",
       "3          1             148750.0  \n",
       "5          2             233240.0  \n",
       "7          1             101150.0  \n",
       "8         25            3718750.0  \n",
       "9          3             642600.0  \n",
       "13         1             115430.0  \n",
       "17         2             285600.0  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# -----------------------------\n",
    "# BLOQUE 4 ‚Äî Aplicar IVA del 19%\n",
    "# -----------------------------\n",
    "\n",
    "# Verificar que df_clean exista\n",
    "try:\n",
    "    _ = df_clean\n",
    "except NameError:\n",
    "    raise NameError(\"El DataFrame 'df_clean' no existe. Ejecuta el BLOQUE 3 antes del BLOQUE 4.\")\n",
    "\n",
    "IVA = 0.19  # 19%\n",
    "\n",
    "# Calcular valor del IVA por unidad\n",
    "df_clean[\"IVA_19\"] = df_clean[\"Precio_COP\"] * IVA\n",
    "\n",
    "# Precio final incluyendo IVA\n",
    "df_clean[\"Precio_con_IVA\"] = df_clean[\"Precio_COP\"] + df_clean[\"IVA_19\"]\n",
    "\n",
    "# Total de venta con IVA\n",
    "df_clean[\"Total_venta_con_IVA\"] = df_clean[\"Precio_con_IVA\"] * df_clean[\"Cantidad\"].astype(float)\n",
    "\n",
    "print(\"\\n--- C√ÅLCULO DE IVA COMPLETADO ---\")\n",
    "display(df_clean[[\"Producto\", \"Precio_COP\", \"IVA_19\", \"Precio_con_IVA\", \"Cantidad\", \"Total_venta_con_IVA\"]].head(10))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "43504743",
   "metadata": {},
   "outputs": [],
   "source": [
    "# BLOQUE 5 ‚Äî Enriquecimiento con departamento\n",
    "\n",
    "# Asignaci√≥n de departamento seg√∫n regi√≥n\n",
    "def asignar_departamento(region):\n",
    "    if pd.isna(region):\n",
    "        return 'Desconocido'\n",
    "    \n",
    "    region = region.lower().strip()\n",
    "    \n",
    "    departamentos = {\n",
    "        'bogota': 'Cundinamarca',\n",
    "        'medellin': 'Antioquia',\n",
    "        'cali': 'Valle Del Cauca',\n",
    "        'barranquilla': 'Atlantico',\n",
    "        'bucaramanga': 'Santander'\n",
    "    }\n",
    "    \n",
    "    return departamentos.get(region, 'Desconocido')\n",
    "\n",
    "df_clean['Departamento'] = df_clean['Region'].apply(asignar_departamento)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "a5b42928",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "‚úî Archivo limpio y final exportado: previsual_limpias.xlsx\n",
      "\n",
      "üìå Tabla final previsualizada:\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_id</th>\n",
       "      <th>Fecha Venta</th>\n",
       "      <th>Producto</th>\n",
       "      <th>Region</th>\n",
       "      <th>Pais</th>\n",
       "      <th>Precio_COP</th>\n",
       "      <th>Cantidad</th>\n",
       "      <th>Metodo_pago</th>\n",
       "      <th>Total_venta_COP</th>\n",
       "      <th>IVA_19</th>\n",
       "      <th>Precio_con_IVA</th>\n",
       "      <th>Total_venta_con_IVA</th>\n",
       "      <th>Departamento</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>G00</td>\n",
       "      <td>13 de enero de 1998</td>\n",
       "      <td>Gafas Plegables De Viaje</td>\n",
       "      <td>Bogota</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>87000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "      <td>87000.0</td>\n",
       "      <td>16530.0</td>\n",
       "      <td>103530.0</td>\n",
       "      <td>103530.0</td>\n",
       "      <td>Cundinamarca</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>G01</td>\n",
       "      <td>13 de enero de 1998</td>\n",
       "      <td>Gafas Polarizadas Deportivas</td>\n",
       "      <td>Medellin</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>150000</td>\n",
       "      <td>2</td>\n",
       "      <td>Efectivo</td>\n",
       "      <td>300000.0</td>\n",
       "      <td>28500.0</td>\n",
       "      <td>178500.0</td>\n",
       "      <td>357000.0</td>\n",
       "      <td>Antioquia</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>M00</td>\n",
       "      <td>13 de enero de 1998</td>\n",
       "      <td>Montura Optica Clasica</td>\n",
       "      <td>Cali</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>32000</td>\n",
       "      <td>1</td>\n",
       "      <td>Cheque</td>\n",
       "      <td>32000.0</td>\n",
       "      <td>6080.0</td>\n",
       "      <td>38080.0</td>\n",
       "      <td>38080.0</td>\n",
       "      <td>Valle Del Cauca</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>L00</td>\n",
       "      <td>14 de enero de 1998</td>\n",
       "      <td>Lentes Progresivos Premium</td>\n",
       "      <td>Bogota</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>125000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "      <td>125000.0</td>\n",
       "      <td>23750.0</td>\n",
       "      <td>148750.0</td>\n",
       "      <td>148750.0</td>\n",
       "      <td>Cundinamarca</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>G03</td>\n",
       "      <td>21 de enero de 1998</td>\n",
       "      <td>Gafas Anti-Reflejo Estandar</td>\n",
       "      <td>Bogota</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>98000</td>\n",
       "      <td>2</td>\n",
       "      <td>Tarjeta</td>\n",
       "      <td>196000.0</td>\n",
       "      <td>18620.0</td>\n",
       "      <td>116620.0</td>\n",
       "      <td>233240.0</td>\n",
       "      <td>Cundinamarca</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>G04</td>\n",
       "      <td>26 de enero de 1998</td>\n",
       "      <td>Gafas De Sol Vintage Redondas</td>\n",
       "      <td>Cali</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>85000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "      <td>85000.0</td>\n",
       "      <td>16150.0</td>\n",
       "      <td>101150.0</td>\n",
       "      <td>101150.0</td>\n",
       "      <td>Valle Del Cauca</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>E00</td>\n",
       "      <td>28 de enero de 1998</td>\n",
       "      <td>Estuche Y Pano Limpieza (Kit)</td>\n",
       "      <td>Bogota</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>125000</td>\n",
       "      <td>25</td>\n",
       "      <td>Tarjeta</td>\n",
       "      <td>3125000.0</td>\n",
       "      <td>23750.0</td>\n",
       "      <td>148750.0</td>\n",
       "      <td>3718750.0</td>\n",
       "      <td>Cundinamarca</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>G05</td>\n",
       "      <td>29 de enero de 1998</td>\n",
       "      <td>Gafas De Seguridad Industriales</td>\n",
       "      <td>Bucaramanga</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>180000</td>\n",
       "      <td>3</td>\n",
       "      <td>Efectivo</td>\n",
       "      <td>540000.0</td>\n",
       "      <td>34200.0</td>\n",
       "      <td>214200.0</td>\n",
       "      <td>642600.0</td>\n",
       "      <td>Santander</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>G07</td>\n",
       "      <td>2 de febrero de 1998</td>\n",
       "      <td>Gafas De Sol Deportivas Wrap</td>\n",
       "      <td>Barranquilla</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>97000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "      <td>97000.0</td>\n",
       "      <td>18430.0</td>\n",
       "      <td>115430.0</td>\n",
       "      <td>115430.0</td>\n",
       "      <td>Atlantico</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>G10</td>\n",
       "      <td>5 de febrero de 1998</td>\n",
       "      <td>Gafas Para Conduccion</td>\n",
       "      <td>Cali</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>120000</td>\n",
       "      <td>2</td>\n",
       "      <td>Efectivo</td>\n",
       "      <td>240000.0</td>\n",
       "      <td>22800.0</td>\n",
       "      <td>142800.0</td>\n",
       "      <td>285600.0</td>\n",
       "      <td>Valle Del Cauca</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>G11</td>\n",
       "      <td>13 de febrero de 1998</td>\n",
       "      <td>Gafas Polarizadas Espejo</td>\n",
       "      <td>Bogota</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>70000</td>\n",
       "      <td>1</td>\n",
       "      <td>Cheque</td>\n",
       "      <td>70000.0</td>\n",
       "      <td>13300.0</td>\n",
       "      <td>83300.0</td>\n",
       "      <td>83300.0</td>\n",
       "      <td>Cundinamarca</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>G15</td>\n",
       "      <td>27 de febrero de 1998</td>\n",
       "      <td>Gafas Bifocales Clasicas</td>\n",
       "      <td>Barranquilla</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>115000</td>\n",
       "      <td>1</td>\n",
       "      <td>Efectivo</td>\n",
       "      <td>115000.0</td>\n",
       "      <td>21850.0</td>\n",
       "      <td>136850.0</td>\n",
       "      <td>136850.0</td>\n",
       "      <td>Atlantico</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>G16</td>\n",
       "      <td>3 de marzo de 1998</td>\n",
       "      <td>Gafas Plegables De Viaje</td>\n",
       "      <td>Medellin</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>87000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "      <td>87000.0</td>\n",
       "      <td>16530.0</td>\n",
       "      <td>103530.0</td>\n",
       "      <td>103530.0</td>\n",
       "      <td>Antioquia</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>M04</td>\n",
       "      <td>3 de marzo de 1998</td>\n",
       "      <td>Montura Deportiva Ligera</td>\n",
       "      <td>Cali</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>240000</td>\n",
       "      <td>3</td>\n",
       "      <td>Efectivo</td>\n",
       "      <td>720000.0</td>\n",
       "      <td>45600.0</td>\n",
       "      <td>285600.0</td>\n",
       "      <td>856800.0</td>\n",
       "      <td>Valle Del Cauca</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>G17</td>\n",
       "      <td>6 de marzo de 1998</td>\n",
       "      <td>Gafas Polarizadas Premium</td>\n",
       "      <td>Bogota</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>200000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "      <td>200000.0</td>\n",
       "      <td>38000.0</td>\n",
       "      <td>238000.0</td>\n",
       "      <td>238000.0</td>\n",
       "      <td>Cundinamarca</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>K00</td>\n",
       "      <td>8 de marzo de 1998</td>\n",
       "      <td>Kit Reparacion Lentes (Tornillos, Pano)</td>\n",
       "      <td>Bogota</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>10000</td>\n",
       "      <td>1</td>\n",
       "      <td>Efectivo</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>1900.0</td>\n",
       "      <td>11900.0</td>\n",
       "      <td>11900.0</td>\n",
       "      <td>Cundinamarca</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>G18</td>\n",
       "      <td>11 de marzo de 1998</td>\n",
       "      <td>Gafas Plegables De Viaje</td>\n",
       "      <td>Cali</td>\n",
       "      <td>Colombia</td>\n",
       "      <td>87000</td>\n",
       "      <td>1</td>\n",
       "      <td>Tarjeta</td>\n",
       "      <td>87000.0</td>\n",
       "      <td>16530.0</td>\n",
       "      <td>103530.0</td>\n",
       "      <td>103530.0</td>\n",
       "      <td>Valle Del Cauca</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_id            Fecha Venta                                 Producto  \\\n",
       "0       G00    13 de enero de 1998                 Gafas Plegables De Viaje   \n",
       "1       G01    13 de enero de 1998             Gafas Polarizadas Deportivas   \n",
       "2       M00    13 de enero de 1998                   Montura Optica Clasica   \n",
       "3       L00    14 de enero de 1998               Lentes Progresivos Premium   \n",
       "5       G03    21 de enero de 1998              Gafas Anti-Reflejo Estandar   \n",
       "7       G04    26 de enero de 1998            Gafas De Sol Vintage Redondas   \n",
       "8       E00    28 de enero de 1998            Estuche Y Pano Limpieza (Kit)   \n",
       "9       G05    29 de enero de 1998          Gafas De Seguridad Industriales   \n",
       "13      G07   2 de febrero de 1998             Gafas De Sol Deportivas Wrap   \n",
       "17      G10   5 de febrero de 1998                    Gafas Para Conduccion   \n",
       "18      G11  13 de febrero de 1998                 Gafas Polarizadas Espejo   \n",
       "24      G15  27 de febrero de 1998                 Gafas Bifocales Clasicas   \n",
       "25      G16     3 de marzo de 1998                 Gafas Plegables De Viaje   \n",
       "26      M04     3 de marzo de 1998                 Montura Deportiva Ligera   \n",
       "27      G17     6 de marzo de 1998                Gafas Polarizadas Premium   \n",
       "28      K00     8 de marzo de 1998  Kit Reparacion Lentes (Tornillos, Pano)   \n",
       "29      G18    11 de marzo de 1998                 Gafas Plegables De Viaje   \n",
       "\n",
       "          Region      Pais  Precio_COP  Cantidad Metodo_pago  Total_venta_COP  \\\n",
       "0         Bogota  Colombia       87000         1     Tarjeta          87000.0   \n",
       "1       Medellin  Colombia      150000         2    Efectivo         300000.0   \n",
       "2           Cali  Colombia       32000         1      Cheque          32000.0   \n",
       "3         Bogota  Colombia      125000         1     Tarjeta         125000.0   \n",
       "5         Bogota  Colombia       98000         2     Tarjeta         196000.0   \n",
       "7           Cali  Colombia       85000         1     Tarjeta          85000.0   \n",
       "8         Bogota  Colombia      125000        25     Tarjeta        3125000.0   \n",
       "9    Bucaramanga  Colombia      180000         3    Efectivo         540000.0   \n",
       "13  Barranquilla  Colombia       97000         1     Tarjeta          97000.0   \n",
       "17          Cali  Colombia      120000         2    Efectivo         240000.0   \n",
       "18        Bogota  Colombia       70000         1      Cheque          70000.0   \n",
       "24  Barranquilla  Colombia      115000         1    Efectivo         115000.0   \n",
       "25      Medellin  Colombia       87000         1     Tarjeta          87000.0   \n",
       "26          Cali  Colombia      240000         3    Efectivo         720000.0   \n",
       "27        Bogota  Colombia      200000         1     Tarjeta         200000.0   \n",
       "28        Bogota  Colombia       10000         1    Efectivo          10000.0   \n",
       "29          Cali  Colombia       87000         1     Tarjeta          87000.0   \n",
       "\n",
       "     IVA_19  Precio_con_IVA  Total_venta_con_IVA     Departamento  \n",
       "0   16530.0        103530.0             103530.0     Cundinamarca  \n",
       "1   28500.0        178500.0             357000.0        Antioquia  \n",
       "2    6080.0         38080.0              38080.0  Valle Del Cauca  \n",
       "3   23750.0        148750.0             148750.0     Cundinamarca  \n",
       "5   18620.0        116620.0             233240.0     Cundinamarca  \n",
       "7   16150.0        101150.0             101150.0  Valle Del Cauca  \n",
       "8   23750.0        148750.0            3718750.0     Cundinamarca  \n",
       "9   34200.0        214200.0             642600.0        Santander  \n",
       "13  18430.0        115430.0             115430.0        Atlantico  \n",
       "17  22800.0        142800.0             285600.0  Valle Del Cauca  \n",
       "18  13300.0         83300.0              83300.0     Cundinamarca  \n",
       "24  21850.0        136850.0             136850.0        Atlantico  \n",
       "25  16530.0        103530.0             103530.0        Antioquia  \n",
       "26  45600.0        285600.0             856800.0  Valle Del Cauca  \n",
       "27  38000.0        238000.0             238000.0     Cundinamarca  \n",
       "28   1900.0         11900.0              11900.0     Cundinamarca  \n",
       "29  16530.0        103530.0             103530.0  Valle Del Cauca  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# ================================================================\n",
    "#  EXPORTACI√ìN FINAL A EXCEL (ESTILO DEL EJEMPLO)\n",
    "# ================================================================\n",
    "\n",
    "# Exportar el archivo limpio con el nombre solicitado\n",
    "df_clean.to_excel('tabla_limpia_previsual.xlsx', index=False)\n",
    "\n",
    "print(\"‚úî Archivo limpio y final exportado: previsual_limpias.xlsx\")\n",
    "\n",
    "# Mostrar tabla final con formato correcto\n",
    "print(\"\\nüìå Tabla final previsualizada:\")\n",
    "display(df_clean)\n",
    "\n",
    "# Exportar nuevamente por seguridad (igual que el ejemplo dado)\n",
    "df_clean.to_excel('previsual_limpias.xlsx', index=False)\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
